{
    "contents" : "# library(shiny)\n# library(foreign)\n\n# Counter\n# A server parameters\nSP <- list()\n# Record the number of poeple who have used the app\n#    since initiation on the server\nSP$npers <- 0\n\nshinyServer(function(input, output){\n\n  # Counter\n  # shinyServer is Started up every time the domain is called.\n  # Use <<- to assign to the global server environment.\n  SP$npers <<- SP$npers + 1\n  output$hits <- renderText({\n    paste0(\"Pageviews: \" , SP$npers)\n  })\n  \n  \noutput$plot <- renderPlot({\n    # Add systematic error\n    # For males and females\n    Davis$weight[Davis$sex==\"M\"] <- Davis$weight[Davis$sex==\"M\"]+input$error_males\n    Davis$weight[Davis$sex==\"F\"] <- Davis$weight[Davis$sex==\"F\"]+input$error_females \n    \n    # For people with low and high weight\n    Davis$weight[Davis$weight<=55] <- Davis$weight[Davis$weight<=55]+input$error_y\n    Davis$weight[Davis$weight>74] <- Davis$weight[Davis$weight>74]-input$error_y    \n    \n    par(mar=c(5,5,2,1))\n    y.limits <- c(0,80)\n    type <- TRUE\n    ###  \n    if(input$groups==\"All units\"){\n      hist(Davis$weight, xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, freq=type, ylim=y.limits, main=\"Histogram: Weight\", xlab=\"weight\")\n      axis(1, at=seq(0, 200,10), labels=seq(0, 200,10), cex.axis=2)\n    }\n    ###\n    if(input$groups==\"males\"){\n      hist(Davis$weight[Davis$sex==\"M\"], freq=type, xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, ylim=y.limits, col=\"#FF5C5C22\", main=\"Histogram: Weight (males only)\", xlab=\"weight\")\n      axis(1, at=seq(0, 200,10), labels=seq(0, 200,10), cex.axis=2)\n    }\n    ###\n    if(input$groups==\"females\"){\n      hist(Davis$weight[Davis$sex==\"F\"], xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, ylim=y.limits, col=\"#003DF540\", freq=type, main=\"Histogram: Weight (females only)\", xlab=\"weight\")\n      axis(1, at=seq(0, 200,10), labels=seq(0, 200,10), cex.axis=2)\n    }  \n    ###\n    if(input$groups==\"males and females\"){\n      hist(Davis$weight[Davis$sex==\"F\"], xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, col=\"#003DF540\", ylim=y.limits, freq=type, main=\"Histogram: Weight (males and females)\", xlab=\"weight\")  \n      hist(Davis$weight[Davis$sex==\"M\"], xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, col=\"#FF5C5C40\", add=T, ylim=y.limits, freq=type)\n      axis(1, at=seq(0, 200,10), labels=seq(0, 200,10), cex.axis=2)\n    }  \n    ###\n    if(input$groups==\"males and females (+ means)\"){\n      hist(Davis$weight[Davis$sex==\"F\"], xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, col=\"#003DF540\", ylim=y.limits, main=\"Histogram: Weight (males and females)\", xlab=\"weight\")  \n      hist(Davis$weight[Davis$sex==\"M\"], xaxt=\"n\", breaks=seq(0, 200, 10), cex.axis=2, cex.lab=2, cex.main=2, col=\"#FF5C5C22\", add=T, ylim=y.limits)\n      abline(v=mean(Davis$weight[Davis$sex==\"F\"]), col=\"blue\")\n      abline(v=mean(Davis$weight[Davis$sex==\"M\"]), col=\"red\")\n      axis(1, at=seq(0, 200,10), labels=seq(0, 200,10), cex.axis=2)\n    }  \n  }, height=400)\n\n\n\n\n\n\n\n})\n",
    "created" : 1446903373861.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4045763770",
    "id" : "1EB10EB1",
    "lastKnownWriteTime" : 1446856850,
    "path" : "C:/Users/paul/Google Drive/Packages/systematic_error_in_subgroups/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}